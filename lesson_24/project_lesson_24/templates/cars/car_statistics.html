{% extends 'base.html' %}

{% block title %}Statystyki Samochod贸w - Cars Manager - My Websites Manager{% endblock %}

{% block extra_css %}
        .section {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        .section h2 {
            color: #007cba;
            margin-top: 0;
            border-bottom: 3px solid #007cba;
            padding-bottom: 10px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #007cba;
            text-align: center;
        }
        .stat-card h3 {
            color: #007cba;
            margin-top: 0;
            font-size: 1.1em;
        }
        .stat-value {
            font-size: 2.5em;
            color: #28a745;
            font-weight: bold;
            margin: 15px 0;
        }
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        .cars-list {
            display: grid;
            gap: 15px;
        }
        .car-item {
            padding: 15px;
            background-color: #f8f9fa;
            border-left: 4px solid #007cba;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .car-item-info h3 {
            margin: 0 0 5px 0;
            color: #333;
            font-size: 1.1em;
        }
        .car-item-meta {
            color: #666;
            font-size: 0.9em;
        }
        .car-item-price {
            font-size: 1.5em;
            color: #28a745;
            font-weight: bold;
        }
        .brand-stats {
            display: grid;
            gap: 12px;
        }
        .brand-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 3px solid #28a745;
        }
        .brand-name {
            font-weight: 600;
            color: #333;
        }
        .brand-stats-info {
            display: flex;
            gap: 20px;
            color: #666;
        }
        .empty-state {
            text-align: center;
            color: #999;
            padding: 30px;
            font-style: italic;
        }
{% endblock %}

{% block content %}
    <h1> Statystyki Samochod贸w</h1>

    <div class="stats-grid">
        <div class="stat-card">
            <h3>Wszystkie samochody</h3>
            <div class="stat-value">{{ total_cars }}</div>
            <div class="stat-label">sztuk</div>
        </div>
        <div class="stat-card">
            <h3>Dostpne</h3>
            <div class="stat-value">{{ available_cars }}</div>
            <div class="stat-label">sztuk</div>
        </div>
        <div class="stat-card">
            <h3>Niedostpne</h3>
            <div class="stat-value">{{ unavailable_cars }}</div>
            <div class="stat-label">sztuk</div>
        </div>
        {% if avg_price %}
            <div class="stat-card">
                <h3>rednia cena</h3>
                <div class="stat-value">{{ avg_price|floatformat:0 }}</div>
                <div class="stat-label">PLN</div>
            </div>
        {% endif %}
        {% if avg_year %}
            <div class="stat-card">
                <h3>redni rok</h3>
                <div class="stat-value">{{ avg_year|floatformat:0 }}</div>
                <div class="stat-label">rok</div>
            </div>
        {% endif %}
    </div>

    <!-- Most Expensive Cars -->
    <div class="section">
        <h2> Najdro偶sze samochody</h2>
        {% if most_expensive %}
            <div class="cars-list">
                {% for car in most_expensive %}
                    <div class="car-item">
                        <div class="car-item-info">
                            <h3>{{ car.brand }} {{ car.model }}</h3>
                            <div class="car-item-meta">Rok: {{ car.year }} | {% if car.dealer %}{{ car.dealer.name }}{% else %}Brak dealera{% endif %}</div>
                        </div>
                        <div class="car-item-price">{{ car.price|floatformat:2 }} PLN</div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="empty-state">Brak samochod贸w w systemie.</p>
        {% endif %}
    </div>

    <!-- Newest Cars -->
    <div class="section">
        <h2> Najnowsze samochody</h2>
        {% if newest_cars %}
            <div class="cars-list">
                {% for car in newest_cars %}
                    <div class="car-item">
                        <div class="car-item-info">
                            <h3>{{ car.brand }} {{ car.model }}</h3>
                            <div class="car-item-meta">Rok: {{ car.year }} | {% if car.dealer %}{{ car.dealer.name }}{% else %}Brak dealera{% endif %}</div>
                        </div>
                        <div class="car-item-price">{{ car.price|floatformat:2 }} PLN</div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="empty-state">Brak samochod贸w w systemie.</p>
        {% endif %}
    </div>

    <!-- Brand Statistics -->
    <div class="section">
        <h2> Statystyki po marce</h2>
        {% if brand_stats %}
            <div class="brand-stats">
                {% for brand in brand_stats %}
                    <div class="brand-item">
                        <span class="brand-name">{{ brand.brand }}</span>
                        <div class="brand-stats-info">
                            <span>{{ brand.count }} sztuk</span>
                            {% if brand.avg_price %}
                                <span>r. cena: {{ brand.avg_price|floatformat:2 }} PLN</span>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="empty-state">Brak danych o markach.</p>
        {% endif %}
    </div>
{% endblock %}

